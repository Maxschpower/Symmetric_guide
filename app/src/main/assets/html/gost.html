<tr>
    <td valign="top" colspan="2" class="smtb">
        <article>
            <h1 class="lev2" id="730"> Алгоритм ГОСТ 28147-89</h1>

            <p>Общая схема алгоритма. Алгоритм, описанный ГОСТ 28147—89 «Системы обработки
                информации. Защита криптографическая. Алгоритм криптографического преобразования»,
                является отечественным стандартом симметричного шифрования (до 1 января 2016 г.) и
                обязателен для реализации в сертифицированных средствах криптографической защиты
                информации, применяемых в государственных информационных системах и, в некоторых
                случаях, в коммерческих системах. Сертификация средств криптографической защиты
                информации требуется для защиты сведений, составляющих государственную тайну РФ, и
                сведений, конфиденциальность которых требуется обеспечить согласно действующему
                законодательству. Также в Российской Федерации применение алгоритма ГОСТ 28147—89
                рекомендовано для защиты банковских информационных систем.</p>
            <p>Алгоритм ГОСТ 28147—89 (рис. 2.21) базируется на схеме Фейстеля и шифрует информацию
                блоками по 64 бит, которые разбиваются на два подблока по 32 бита (I, и <i>R).</i>
                Подблок <i>R,</i> обрабатывается функцией раундового преобразования, после чего его
                значение складывается со значением подблока Lj, затем подблоки меняются местами.
                Алгоритм имеет 16 или 32 раунда в зависимости от режима шифрования (вычисление
                имитовставки или другие режимы шифрования).</p>

            <img src="https://studme.org/htm/img/15/3044/124.png" alt="Схема раунда алгоритма ГОСТ 28147—89">
            <p><i>Рис. 2.21.</i><b> <strong>Схема раунда алгоритма ГОСТ 28147—89</strong></b></p>
            <p>В каждом раунде алгоритма выполняются следующие преобразования.</p>
            <p>1. <i>Наложение ключа.</i> Содержание подблока <i>R<sub>i</sub></i> складывается по
                модулю 2<sup>32 </sup>с ключом раунда <i>К. Kj</i> — это 32-битовая часть исходного
                ключа, используемая в качестве раундового. Алгоритм ГОСТ 28147—89 нс использует
                процедуру расширения ключа, исходный 256-битный ключ шифрования представляется в
                виде конкатенации (сцепления) восьми 32-битовых подключей (рис. 2.22):
                <i>К<sub>0</sub>, К<sub>{</sub>, К<sub>т</sub> К,, К<sub>А</sub>, К<sub>5</sub>,
                    К<sub>6</sub>, К<sub>7</sub>.</i></p>
            <p>В процессе шифрования используется один из этих подключей <i>К•</i></p>
            <p>• с 1-го по 24-й раунд — в прямой последовательности:
                <img src="https://studme.org/htm/img/15/3044/125.png"></p>
            <p>• с 25-го но 32-й раунд — в обратной последовательности:</p>
            <p>
                <img src="https://studme.org/htm/img/15/3044/126.png"></p>
            <p>
                <img src="https://studme.org/htm/img/15/3044/127.png"></p>
            <p><i>Рис. 2.22.</i> <strong>Строение ключа шифрования алгоритма ГОСТ 28147—89</strong>
            </p>
            <p>2. <i>Табличная замена.</i> После наложения ключа подблок <i>R<sub>i</sub></i>
                разбивается на восемь частей но 4 бита, значение каждой из которых по отдельности
                заменяется в соответствии со своей таблицей замены (S-блоком). Всего используется
                восемь S-блоков — S<sub>0</sub>, S,, S<sub>2</sub>, S<sub>3</sub>, S<sub>4</sub>,
                S<sub>5</sub>, S<sub>6</sub>, S<sub>7</sub>. Каждый S-блок алгоритма ГОСТ 28147—89
                представляет собой вектор (одномерный массив) с ^элементами, пронумерованными от 0
                до 15. Значениями S-блока являются 4-битовые числа, т.е. целые числа от 0 до 15.</p>
            <p>Из таблицы S-блока берется элемент, порядковый номер которого совпадает со значением,
                пришедшим на вход подстановки.</p>
            <p>Пример 2.6.</p>
            <p>Пусть имеется S-блок следующего вида:</p>
            <p>
                <img src="https://studme.org/htm/img/15/3044/128.png"></p>

            <p>Пусть на вход этого S-блока подано значение 0100<sub>2</sub> = 4. Выходом S-блока
                будет 4-й элемент таблицы замен, т.е. 15 = 1111<sub>2</sub> (нумерация элементов
                начинается с нуля). <sup><a class="annot"
                                            href="https://studme.org/239563/informatika/algoritm_gost_28147_shifr_magma_gost_3412_2015#gads_btm"
                                            name="annot_1" id="annot_1">[1]</a></sup></p>
            <p>лиц замен не определены стандартом, как это сделано, например, в шифре DES. Сменные
                значения таблиц замен существенно затрудняют криптоанализ алгоритма. В то же время
                стойкость алгоритма существенно зависит от их правильного выбора.</p>
            <p>К сожалению, алгоритм ГОСТ 28147—89 имеет «слабые» таблицы замен, при использовании
                которых алгоритм может быть достаточно легко раскрыт криптоаналитическими методами.
                К числу «слабых» относится, например, тривиальная таблица замен, в которой вход
                равен выходу (табл. 2.16).</p>
            <p><i>Таблица 2.16</i></p>
            <p>Пример слабого S-блока</p>
            <table border="1">
                <tbody>
                <tr>
                    <td>
                        <p>1</p>
                    </td>
                    <td>
                        <p>2</p>
                    </td>
                    <td>
                        <p>3</p>
                    </td>
                    <td>
                        <p>4</p>
                    </td>
                    <td>
                        <p>5</p>
                    </td>
                    <td>
                        <p>6</p>
                    </td>
                    <td>
                        <p>7</p>
                    </td>
                    <td>
                        <p>8</p>
                    </td>
                    <td>
                        <p>9</p>
                    </td>
                    <td>
                        <p>10</p>
                    </td>
                    <td>
                        <p>11</p>
                    </td>
                    <td>
                        <p>12</p>
                    </td>
                    <td>
                        <p>13</p>
                    </td>
                    <td>
                        <p>14</p>
                    </td>
                    <td>
                        <p>15</p>
                    </td>
                    <td>
                        <p>16</p>
                    </td>
                </tr>
                </tbody>
            </table>
            <p>Считается, что конкретные значения таблиц замен должны храниться в секрете и являются
                долговременным ключевым элементом, т.е. действуют в течение гораздо более
                длительного срока, чем отдельные ключи. Однако секретные значения таблиц замен не
                являются частью ключа и не могут увеличить его эффективную длину.</p>
            <p>Действительно, секретные таблицы замен могут быть вычислены с помощью следующей
                атаки, которую возможно применять на практике:</p>
            <ul>
                <li>• устанавливается нулевой ключ и выполняется поиск «нулевого вектора», т.е.
                    значения <i>z</i> = <i>F(</i>0), где <i>F —</i> функция раундового
                    преобразования алгоритма. Это требует порядка 2<sup>32</sup> тестовых операций
                    шифрования;
                </li>
                <li>• с помощью нулевого вектора вычисляются значения таблиц замен, что занимает не
                    более 2<sup>11</sup> операций.
                </li>
            </ul>
            <p>Однако даже при нарушении конфиденциальности таблиц замен стойкость шифра остается
                чрезвычайно высокой и не становится ниже допустимого предела.</p>
            <p>Предполагается также, что таблицы замен являются общими для всех узлов шифрования в
                рамках одной системы криптографической защиты.</p>
            <p>Совершенствование структуры S-блоков является одной из наиболее интенсивно
                исследуемых проблем в области симметричных блочных шифров. По сути, требуется, чтобы
                любые изменения входов S-блоков выливались в <i>случайные</i> на вид изменения
                выходных данных. С одной стороны, чем больше S-блоки, тем более устойчив алгоритм к
                методам линейного и дифференциального криптоанализа. С другой стороны, большую
                таблицу замен сложнее проектировать.</p>
            <p>В современных алгоритмах S-блоки обычно представляют собой вектор (одномерный
                массив), содержащий <i>2" т-</i>битовых элементов. Вход блока определяет номер
                элемента, значение которого служит выходом S-блока.</p>
            <p>Для проектирования S-блоков был выдвинут целый ряд критериев. Таблица замен должна
                удовлетворять:</p>
            <ul>
                <li>• строгому лавинному критерию;</li>
                <li>• критерию независимости битов;</li>
                <li>• требованию нелинейности от входных значений.</li>
            </ul>
            <p>Для выполнения последнего требования было предложено задавать линейную комбинацию <i>i</i>
                битов (<i>i =</i> 1<b>, </b>..., <i>т)</i> значений таблицы замен
                <i>бентфункциями</i> (англ, <i>bent —</i> отклоняющийся, в данном случае — от
                линейных функций). Бент-функции образуют специальный класс булевых функций,
                характеризующихся высшим классом нелинейности и соответствием строгому лавинному
                критерию.</p>
            <p>В некоторых работах для S-блоков предлагается проверка выполнения гарантированного
                лавинного эффекта порядка у — при изменении одного входного бита меняется, по
                крайней мере, у выходных бит S-блока. Свойство гарантированного лавинного эффекта
                порядка у от 2 до 5 обеспечивает достаточно хорошие диффузионные характеристики
                S-блоков для любого алгоритма шифрования.</p>
            <p>При проектировании достаточно больших таблиц замен могут быть использованы следующие
                подходы:</p>
            <ul>
                <li>• случайный выбор (для S-блоков небольшого размера может привести к созданию
                    слабых таблиц замен);
                </li>
                <li>• случайный выбор с последующей проверкой на соответствие различным критериям и
                    отбраковкой слабых S-блоков;
                </li>
                <li>• ручной выбор (для S-блоков больших размеров слишком трудоемок);</li>
                <li>• математический подход, например генерация с использованием бент- функций (этот
                    подход применен в алгоритме CAST).
                </li>
            </ul>
            <p>Можно предложить следующий порядок<sup><a class="annot"
                                                         href="https://studme.org/239563/informatika/algoritm_gost_28147_shifr_magma_gost_3412_2015#gads_btm"
                                                         name="annot_2" id="annot_2">[2]</a></sup>
                проектирования отдельных S- блоков алгоритма ГОСТ 28147—89:</p>
            <ul>
                <li>• каждый S-блок может быть описан четверкой логических функций, каждая из
                    функций должна иметь четыре логических аргумента;
                </li>
                <li>• необходимо, чтобы эти функции были достаточно сложными. Это требование
                    сложности невозможно выразить формально, однако в качестве необходимого условия
                    можно потребовать, чтобы соответствующие логические функции, записанные в
                    минимальной форме (т.е. с минимально возможной длиной выражения) с
                    использованием основных логических операций, не были короче некоторого
                    необходимого значения;
                </li>
                <li>• отдельные функции, даже используемые в разных таблицах замен, должны
                    различаться между собой в достаточной степени.
                </li>
            </ul>
            <p>Описаны и другие алгоритмы<sup><a class="annot"
                                                 href="https://studme.org/239563/informatika/algoritm_gost_28147_shifr_magma_gost_3412_2015#gads_btm"
                                                 name="annot_3" id="annot_3">[3]</a></sup>
                построения S-блоков для шифра ГОСТ 28147—89. На практике обычно достаточно получить
                узлы замен как независимые случайные перестановки чисел от 0 до 15.</p>
            <p>Не требуется, чтобы S-блоки были простыми перестановками чисел от О до 15, т.е.
                допускаются повторение элементов, а также необратимые замены, однако в этом случае
                снижается стойкость шифра.</p>
            <p>Попытки проектирования S-блоков как функции от ключа шифрования показали, что
                использование зависящих от ключа S-блоков обычно ослабляет шифр (как для DES, так и
                для ГОСТ 28147—89).</p>
            <p><b>Режимы работы алгоритма ГОСТ 28147—89. </b>Алгоритм ГОСТ 28147—89 имеет четыре
                режима работы, которые отличаются от общепринятых:</p>
            <ul>
                <li>• простой замены;</li>
                <li>• гаммирования;</li>
                <li>• гаммирования с обратной связью;</li>
                <li>• выработки имитовставки.</li>
            </ul>
            <p><i><b>Режим простой замены.</b></i> В режиме простой замены производится независимое
                шифрование 64-битных блоков текста одним и тем же ключом с выполнением 32 раундов
                алгоритма ГОСТ 28147—89. Аналогично режиму электронной кодовой книги ЕСВ, по причине
                раздельного шифрования режим простой замены не рекомендуется использовать для
                шифрования длинных сообщений; он применим для шифрования ключей в многоключевых
                схемах.</p>
            <p><i><b>Режим гаммирования.</b></i> В режиме гаммирования каждый блок открытого текста
                побитно складывается по модулю 2 (XOR) с 64-битным блоком гаммы шифра (рис. 2.23).
                <i>Гамма шифра</i> — псевдослучайная последовательность, которая вырабатывается
                следующим образом:</p>
            <ul>
                <li>• в 32-битовые регистры <i>N<sub>{</sub></i> и <i>N<sub>2</sub></i> записываются
                    их начальные значения - половины 64-битной величины, называемой <i>синхропосылкой.</i>
                    Синхропосылка является аналогом вектора инициализации в режимах СВС, CFB, OFB;
                </li>
                <li>• выполняется шифрование содержимого <i>N<sub>{</sub></i> и <i>N<sub>0</sub></i>
                    в режиме простой замены, результаты записываются в регистры JV, и
                    <i>N<sub>2</sub>;</i></li>
                <li>• содержимое <i>N<sub>{</sub></i> складывается по модулю (2<sup>32</sup> -1) со
                    значением константы <i>А<sub>х</sub> =</i> 2<sup>24</sup> + 2<sup>16</sup> +
                    2<sup>8</sup> + 4. Если получено значение, равное нулю, оно заменяется на 2
                    <sup>32</sup> - 1. Результат сложения записывается в регистр
                    <i>N<sub>v</sub></i> С учетом сделанного замечания корректная с математической
                    точки зрения формула для вычисления нового значения А, может быть записана как
                    <i>N<sub>u</sub> = = (N<sub>u</sub>_<sub>{</sub></i> + А, - l)mod(2<sup>32</sup>
                    - 1) + 1;
                </li>
                <li>• содержимое <i>N<sub>2</sub></i> складывается по модулю 2<sup>32</sup> со
                    значением константы <i>А<sub>2</sub> =</i> 2<sup>24</sup> + 2<sup>lfi</sup> +
                    2<sup>s</sup> + 1, результат сложения записывается в регистр <i>N<sub>2</sub>: N<sub>2i</sub>
                        = = (N<sub>2i</sub>_<sub>{</sub></i> + A<sub>2</sub>)mod2<sup>32</sup>;
                </li>
                <li>• содержимое регистров <i>N<sub>{</sub></i> и JV<sub>2</sub> подается на выход
                    алгоритма выработки гаммы, г.е. представляет блок гаммы, которая затем
                    складывается с блоком открытого текста;
                </li>
                <li>• при необходимости продолжения повторяются все шаги, кроме первого.</li>
            </ul>
            <img src="https://studme.org/htm/img/15/3044/131.png" alt="Режим гаммирования">
            <p><i>Рис. 2.23.</i><b> <strong>Режим гаммирования</strong></b></p>
            <p>Период повторения генерируемой гаммы <i>М</i> составляет
                2<sup>32</sup>(2<sup>32</sup> - 1), т.е.</p>
            <p><i>М</i> ~ 2<sup>(И</sup>.</p>
            <p><i>Режим гаммирования с обратной связью.</i> Этот режим аналогичен предыдущему, но в
                качестве заполнения регистров <i>N<sub>{</sub></i> и <i>N<sub>2</sub>,</i> начиная
                со второго блока, используется результат шифрования предыдущего блока открытого
                текста (рис. 2.24).</p>
            <img src="https://studme.org/htm/img/15/3044/132.png" alt="Режим гаммирования с обратной связью">
            <p><i><b>Рис. 2.24.</b></i> Режим гаммирования с обратной связью</p>
            <p><i>Режим выработки имитовставки. Имитовставка —</i> это криптографическая контрольная
                сумма, вычисляемая с использованием ключа шифрования и предназначенная для проверки
                целостности сообщений. Для вычисления имитовставки существует специальный режим
                алгоритма ГОСТ 28147—89 (рис. 2.25), несколько похожий на режим сцепления блоков
                шифротекста СВС (однако без использования синхропосылки — вектора инициализации):
            </p>
            <ul>
                <li>• первый блок информации, для которого вычисляется имитовставка, шифруется
                    алгоритмом ГОСТ в сокращенном режиме, в котором выполняются только 16 раундов из
                    32;
                </li>
                <li>• результат шифрования суммируется (с помощью операции побитового XOR) со
                    следующим блоком информации;
                </li>
                <li>• результат суммирования снова шифруется в сокращенном режиме;</li>
                <li>• при необходимости все шаги, кроме первого, повторяются.</li>
            </ul>
            <img src="https://studme.org/htm/img/15/3044/133.png" alt="Режим выработки имитовставки">
            <p><i><b>Рис. 2.25.</b></i> Режим выработки имитовставки</p>
            <p>Имитовставкой является 64-битное содержимое последнего блока <i>Y<sub>N </sub></i>или
                его часть. Чаще всего используется 32-битная имитовставка, т.е. половина последнего
                блока шифра. Этого достаточно, так как имитовставка, как и любая контрольная сумма,
                предназначена, прежде всего, для защиты от случайных искажений информации.</p>
            <p>В общем случае вероятность успешного навязывания ложных данных равна 2", где <i>п
                —</i> разрядность имитовставки.</p>
            <p>Для защиты от преднамеренной модификации данных применяют другие криптографические
                методы — в первую очередь электронную цифровую подпись (ЭЦП).</p>
            <p>Поскольку имитовставка зависит не только от открытого текста, но и от секретного
                ключа шифрования, для противника вычислительно неразрешимы две задачи:</p>
            <ul>
                <li>1) вычисление имитовставки для заданной незашифрованной информации;</li>
                <li>2) подбор открытых данных иод заданную имитовставку.</li>
            </ul>
            <p>Имитовставка используется следующим образом:</p>
            <ul>
                <li>• при шифровании какого-либо текста вычисляется имитовставка открытого текста и
                    посылается вместе с шифротекстом;
                </li>
                <li>• после расшифровки имитовставка снова вычисляется и сравнивается с
                    присланной;
                </li>
                <li>• если вычисленная и присланная имитовставки не совпали, значит, либо шифротекст
                    был искажен при передаче, либо при расшифровке использовались неверные ключи.
                </li>
            </ul>
            <p>Рассмотрим подробнее влияние искажений шифротекста на полученные в результате
                расшифровки данные.</p>
            <p>В режиме простой замены искажение блока шифротекста приводит при расшифровании к
                непредсказуемым изменениям соответствующего блока открытого текста. В режиме
                гаммирования все изменения открытого текста предсказуемы. В режиме гаммирования с
                обратной связью искажение блока шифротекста после расшифровки приводит к изменениям
                двух блоков открытого текста, при этом один из них оказывается искаженным
                предсказуемым образом, а другой — непредсказуемым образом. Непредсказуемые изменения
                в расшифрованном массиве данных могут быть обнаружены только в том случае, когда
                исходные данные избыточны, т.е. представляют осмысленный текст на естественном
                языке. В остальных случаях единственная возможность обнаружить изменения или,
                напротив, подтвердить целостность — использование контрольной суммы,
                криптографической контрольной суммы (имитовставки) или ЭЦП.</p>
            <p>Имитовставка особенно полезна для проверки правильности расшифрованной ключевой
                информации в многоключевых схемах.</p>
            <p><b>Криптостойкость алгоритма ГОСТ 28147—89. </b>В 1994 г. описание алгоритма ГОСТ
                28147—89 было переведено на английский язык и опубликовано. Именно после этого стали
                появляться результаты его анализа, выполненные зарубежными специалистами.</p>
            <p>В течение значительного времени не было найдено каких-либо практически осуществимых
                атак<sup><a class="annot"
                            href="https://studme.org/239563/informatika/algoritm_gost_28147_shifr_magma_gost_3412_2015#gads_btm"
                            name="annot_4" id="annot_4">[4]</a></sup>. В открытой публикации
                довольно мало работ, посвященных криптоанализу ГОСТ, по их результатам можно сделать
                вывод о весьма высокой криптостойкости отечественного стандарта шифрования. Высокая
                стойкость достигается за счет:</p>
            <ul>
                <li>• большой длины ключа — 256 бит;</li>
                <li>• 32 раундов преобразований; уже после восьми раундов достигается полный эффект
                    рассеивания входных данных.
                </li>
            </ul>
            <p>Стандарт ГОСТ 28147—89 проявляет стойкость к линейному криптоанализу уже после пяти
                раундов, а к классическому дифференциальному - после семи раундов (на уровне
                стойкости 2<sup>128</sup>). Основной проблемой крип- тоалгоритома ГОСТ 28147—89
                является довольно простое расписание ключей, что позволяет строить, по крайней мере
                теоретически, атаки меньшей сложности, чем полный перебор ключевого пространства.
                Полнораундо- вый алгоритм ГОСТ 28147—89 может быть вскрыт с помощью
                дифференциального криптоанализа на связанных ключах, но только в случае
                использования слабых таблиц замен. Представляет интерес атака методом бумеранга с
                использованием связанных ключей<sup><a class="annot"
                                                       href="https://studme.org/239563/informatika/algoritm_gost_28147_shifr_magma_gost_3412_2015#gads_btm"
                                                       name="annot_5" id="annot_5">[5]</a></sup>,
                которая позволяет определить ключ шифра с использованием всего 226 операций, однако
                требует сложного выбора исходных данных.</p>
            <p>Отечественные ученые А. Г. Ростовцев и Е. Б. Маховенко в 2001 г. предложили
                принципиально новый метод криптоанализа (по мнению авторов, существенно более
                эффективный, чем линейный и дифференциальный криптоанализ) путем формирования
                целевой функции от известного открытого текста, соответствующего ему шифротекста и
                искомого значения ключа и нахождения ее экстремума, соответствующего истинному
                значению ключа<sup><a class="annot"
                                      href="https://studme.org/239563/informatika/algoritm_gost_28147_shifr_magma_gost_3412_2015#gads_btm"
                                      name="annot_6" id="annot_6">[6]</a></sup>. Этими авторами был
                найден большой класс слабых ключей алгоритма ГОСТ 28147—89, которые позволяют
                вскрыть алгоритм с помощью всего четырех выбранных открытых текстов и
                соответствующих им шифротекстов с достаточно низкой сложностью. Классы слабых ключей
                ГОСТ 28147—89 описаны и в других работах<sup><a class="annot"
                                                                href="https://studme.org/239563/informatika/algoritm_gost_28147_shifr_magma_gost_3412_2015#gads_btm"
                                                                name="annot_7" id="annot_7">[7]</a></sup>.
            </p>
            <p>В 2011 г. предложена новая атака «рефлексивная встреча посередине», незначительно
                снижающая стойкость ГОСТ 28147—89 (с 2256 до 2225)<sup><a class="annot"
                                                                          href="https://studme.org/239563/informatika/algoritm_gost_28147_shifr_magma_gost_3412_2015#gads_btm"
                                                                          name="annot_8"
                                                                          id="annot_8">[8]</a></sup>.
                Лучший результата криптоанализа алгоритма по состоянию на 2012 г. позволяет снизить
                его стойкость до 2<sup>192</sup>, требуя относительно большого размера шифротекста и
                объема предварительно сформированных данных<sup><a class="annot"
                                                                   href="https://studme.org/239563/informatika/algoritm_gost_28147_shifr_magma_gost_3412_2015#gads_btm"
                                                                   name="annot_9"
                                                                   id="annot_9">[9]</a></sup>.
                Несмотря на предложенные атаки, на современном уровне развития вычислительной
                техники ГОСТ 28147—89 сохраняет практическую стойкость.</p>
        </article>
    </td>
</tr>